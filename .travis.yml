language: python

python:
  - "2.7"

install:
  - pip install cwlref-runner
  - pip install cwltool
  - pip install cwl-runner

script:
  # Validate schama-salad-tool
  - schema-salad-tool /home/travis/virtualenv/python2.7.13/lib/python2.7/site-packages/cwltool/schemas/v1.0/CommonWorkflowLanguage.yml hello.cwl
  - schema-salad-tool /home/travis/virtualenv/python2.7.13/lib/python2.7/site-packages/cwltool/schemas/v1.0/CommonWorkflowLanguage.yml grep.cwl
  - schema-salad-tool /home/travis/virtualenv/python2.7.13/lib/python2.7/site-packages/cwltool/schemas/v1.0/CommonWorkflowLanguage.yml wc.cwl
  - schema-salad-tool /home/travis/virtualenv/python2.7.13/lib/python2.7/site-packages/cwltool/schemas/v1.0/CommonWorkflowLanguage.yml grep-and-count.cwl
  # test result output
  - cwltool hello.cwl  --message "hello world" ; grep "hello world" hello-out.txt
  # Workflow
  - cwltool grep-and-count.cwl --file_to_searc mock.txt --pattern one ;   awk '{print $1}' wcout.txt  | grep 2
  - cwltool grep-and-count.cwl --file_to_searc mock2.txt --pattern one ;   awk '{print $1}' wcout.txt  | grep 3
