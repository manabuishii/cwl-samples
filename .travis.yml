language: python

python:
  - "2.7"

install:
  - pip install cwlref-runner
  - pip install cwltool
  - pip install cwl-runner

script:
  # Validate schama-salad-tool
  - schema-salad-tool /home/travis/virtualenv/python2.7.13/lib/python2.7/site-packages/cwltool/schemas/v1.0/CommonWorkflowLanguage.yml helloworld.cwl
  - schema-salad-tool /home/travis/virtualenv/python2.7.13/lib/python2.7/site-packages/cwltool/schemas/v1.0/CommonWorkflowLanguage.yml grep.cwl
  - schema-salad-tool /home/travis/virtualenv/python2.7.13/lib/python2.7/site-packages/cwltool/schemas/v1.0/CommonWorkflowLanguage.yml wc.cwl
  - schema-salad-tool /home/travis/virtualenv/python2.7.13/lib/python2.7/site-packages/cwltool/schemas/v1.0/CommonWorkflowLanguage.yml grep-and-count.cwl
  # test result output
  - cwltool helloworld.cwl  --message "Hello World" ; grep "Hello World" hello-out.txt
  # Workflow
  - cwltool grep-and-count.cwl --target_file mock.txt --grep_pattern one ;   awk '{print $1}' wcout.txt  | grep 2
  - cwltool grep-and-count.cwl --target_file mock2.txt --grep_pattern one ;   awk '{print $1}' wcout.txt  | grep 3
